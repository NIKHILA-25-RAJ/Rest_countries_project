CREATE OR REPLACE WAREHOUSE my_wh
WITH
  WAREHOUSE_SIZE = 'XSMALL'
  AUTO_SUSPEND = 60
  AUTO_RESUME = TRUE
  INITIALLY_SUSPENDED = TRUE;

 
CREATE OR REPLACE DATABASE country_db;
CREATE OR REPLACE SCHEMA country_db.public;

CREATE OR REPLACE TABLE countries_table (
    name STRING,
    official_name STRING,
    capital STRING,
    region STRING,
    subregion STRING,
    population INT,
    area_km2 INT,
    independent BOOLEAN,
    un_member BOOLEAN,
    languages STRING,
    currencies STRING,
    flag STRING
);


file_format

CREATE OR REPLACE FILE FORMAT my_csv_format
TYPE = 'CSV'
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
SKIP_HEADER = 1
NULL_IF = ('NULL', 'null')
EMPTY_FIELD_AS_NULL = TRUE;

CREATE OR REPLACE STAGE my_s3_stage
URL = 's3://countrybkt-my/kafka-output/'
CREDENTIALS = (
  AWS_KEY_ID = 'your aws_key'
  AWS_SECRET_KEY = 'your aws_secret_key '
)
FILE_FORMAT = my_csv_format;


s3_table

COPY INTO countries_table
FROM @my_s3_stage
FILE_FORMAT = (FORMAT_NAME = my_csv_format);


SELECT * FROM countries_table LIMIT 10;

LIST @my_s3_stage;
